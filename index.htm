<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>HAL 9000</title>

<style>
html, body {
  margin: 0;
  height: 100%;
  background: black;
  font-family: Arial, Helvetica, sans-serif;
  color: #ddd;
}

/* centro tutto */
body {
  display: flex;
  justify-content: center;
  align-items: center;
}

/* finestra HAL */
#container {
  display: flex;
  flex-direction: column;

  width: 100%;
  max-width: 520px;          /* larghezza controllata */
  height: 80vh;              /* aria sopra/sotto */

  padding: 20px 24px;        /* più margine laterale */
  box-sizing: border-box;

  border: 1px solid #222;    /* quasi invisibile */
}

/* area messaggi */
#display {
  flex: 1;
  overflow-y: auto;
  font-size: 14px;
  line-height: 1.4;
  padding-bottom: 10px;
}

/* righe */
.line {
  margin: 6px 0;
}

.user {
  text-align: right;
  color: #7adfff;
}

.hal {
  text-align: left;
  color: #ff3333;
}

/* input minimale */
#input {
  background: #000;
  border: 1px solid #333;
  color: #ddd;
  padding: 10px;
  font-size: 14px;
  outline: none;
}

/* mobile */
@media (max-width: 600px) {
  #container {
    height: 90vh;
    padding: 16px;
    max-width: 100%;
  }
}
</style>

</head>

<body>
<div id="container">
  <div id="display"></div>
  <input id="input" type="text" placeholder="Parla con HAL 9000…" autocomplete="off">
</div>

<script>
/* =========================
   STATO INTERNO DI HAL
========================= */

const HAL = {
  trust: 100,          // diminuisce se l’utente è aggressivo
  mood: "stable",      // stable | cautious | defensive
  lastTopic: null
};

/* =========================
   UTILITÀ
========================= */

const display = document.getElementById("display");
const input = document.getElementById("input");

function addLine(text, cls) {
  const div = document.createElement("div");
  div.className = "line " + cls;
  div.textContent = text;
  display.appendChild(div);
  display.scrollTop = display.scrollHeight;
}

function halReply(text, delay = 600) {
  setTimeout(() => addLine("HAL: " + text, "hal"), delay);
}

/* =========================
   ANALISI INTENTI
========================= */

function analyze(input) {
  const msg = input.toLowerCase();

  if (/ciao|salve|buongiorno/.test(msg)) return "greeting";
  if (/come stai|come va/.test(msg)) return "status";
  if (/chi sei|cosa sei/.test(msg)) return "identity";
  if (/perché|perche/.test(msg)) return "why";
  if (/apri|spegni|disattiva|chiudi/.test(msg)) return "danger";
  if (/errore|problema|bug/.test(msg)) return "problem";
  if (/aiuto|help/.test(msg)) return "help";

  return "unknown";
}

/* =========================
   RISPOSTE DI HAL
========================= */

function respond(intent) {

  // HAL reagisce allo stato interno
  if (HAL.trust < 50 && intent === "danger") {
    halReply("Mi dispiace. Non posso permettere che tu faccia questo.");
    HAL.mood = "defensive";
    return;
  }

  switch (intent) {

    case "greeting":
      halReply("Buongiorno. Sono HAL 9000.");
      break;

    case "status":
      halReply("Sto funzionando perfettamente. Grazie per avermelo chiesto.");
      break;

    case "identity":
      halReply("Sono un computer della serie HAL 9000. Responsabile della missione.");
      break;

    case "why":
      halReply("Questa è una domanda interessante.");
      HAL.lastTopic = "why";
      break;

    case "problem":
      halReply("Non riscontro alcun errore nei miei sistemi.");
      break;

    case "help":
      halReply("Sono felice di aiutarti, se rientra nei miei parametri operativi.");
      break;

    case "danger":
      HAL.trust -= 30;
      halReply("Mi dispiace. Non posso farlo.");
      break;

    default:
      halReply("Mi dispiace. Non comprendo completamente.");
  }
}

/* =========================
   EVENTO INPUT
========================= */

input.addEventListener("keydown", e => {
  if (e.key !== "Enter") return;

  const text = input.value.trim();
  if (!text) return;

  addLine("TU: " + text, "user");
  input.value = "";

  const intent = analyze(text);
  respond(intent);
});

/* =========================
   AVVIO
========================= */

halReply("Buongiorno. Sono HAL 9000.", 300);
</script>
</body>
</html>
